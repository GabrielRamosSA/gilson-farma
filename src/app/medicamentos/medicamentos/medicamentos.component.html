<!-- Barra de navegação fixa no topo com logo, busca e botões de ação. -->
<nav class="barra-navegacao">
  <!-- Seção da logo/identidade visual da farmácia. -->
  <div class="secao-logo">
    <div class="container-logo">
      <!-- Ícone de comprimidos usando Font Awesome para reforçar o tema. -->
      <i class="fas fa-pills icone-logo"></i>
      <!-- Nome da marca em destaque na barra de navegação. -->
      <h1>Farma Gilson</h1>
    </div>
  </div>
  
  <!-- Área central com a barra de busca de produtos. -->
  <div class="secao-busca">
    <div class="container-busca">
      <!-- Ícone de lupa dentro do campo de busca. -->
      <i class="fas fa-search icone-busca"></i>
      <!-- Campo de busca com binding bidirecional (ngModel) ao termo de pesquisa.
           Observação: para [(ngModel)] funcionar, o componente precisa importar FormsModule. -->
      <input 
        type="text" 
        placeholder="Buscar medicamentos, vitaminas, cosméticos..."
        [(ngModel)]="termoPesquisa"
        (input)="filtrarProdutos(filtroAtivo)">
      <!-- Botão circular para limpar a busca; só aparece quando há texto digitado. -->
      <button class="limpar-busca prominente" *ngIf="termoPesquisa.length > 0" (click)="limparPesquisa()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <!-- Bloco de sugestões e feedback quando não há resultados para o termo digitado. -->
    <div class="sugestoes-busca" *ngIf="termoPesquisa.length >= 2 && produtosFiltrados.length === 0">
      <!-- Mensagem ao usuário com o termo pesquisado. -->
      <p>Nenhum produto encontrado para "{{ termoPesquisa }}"</p>
      <div class="lista-sugestoes">
        <!-- Texto auxiliar antes dos botões de sugestão. -->
        <span>Sugestões:</span>
        <!-- Sugestão rápida: define diretamente o termo de pesquisa ao clicar. -->
        <button class="botao-sugestao" (click)="termoPesquisa = 'dor'">Dor</button>
        <button class="botao-sugestao" (click)="termoPesquisa = 'febre'">Febre</button>
        <button class="botao-sugestao" (click)="termoPesquisa = 'pressão'">Pressão</button>
        <button class="botao-sugestao" (click)="termoPesquisa = 'diabetes'">Diabetes</button>
      </div>
    </div>
  </div>
  
  <!-- Botões de navegação da direita: voltar e abrir carrinho. -->
  <div class="botoes-navegacao">
    <!-- Botão de voltar para página anterior ou rota definida no TS. -->
    <div class="botao-nav" (click)="voltar()">
      <i class="fas fa-arrow-left"></i>
      <span>Voltar</span>
    </div>
    <!-- Botão do carrinho com contador; exibe selo quando há itens. -->
    <div class="botao-nav botao-carrinho" (click)="abrirCarrinho()">
      <i class="fas fa-shopping-cart"></i>
      <span>Carrinho ({{ contadorCarrinho }})</span>
      <!-- Selo numérico aparece apenas quando há itens no carrinho. -->
      <div class="selo-carrinho" *ngIf="contadorCarrinho > 0">{{ contadorCarrinho }}</div>
    </div>
  </div>
</nav>

<!-- Modal de carrinho: abre sobre a página quando modalAberto é true. -->
<div class="modal" *ngIf="modalAberto" (click)="fecharCarrinho()">
  <!-- Conteúdo da modal; clique aqui não fecha a modal (stopPropagation). -->
  <div class="conteudo-modal" (click)="$event.stopPropagation()">
    <div class="cabecalho-modal">
      <!-- Título da modal com ícone de carrinho. -->
      <h3><i class="fas fa-shopping-cart"></i> Seu Carrinho</h3>
      <!-- Botão de fechar modal. -->
      <button class="botao-fechar" (click)="fecharCarrinho()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <!-- Lista de itens no carrinho quando houver pelo menos 1 item; caso contrário, mostra template de vazio abaixo. -->
    <div class="itens-carrinho" *ngIf="carrinho.length > 0; else carrinhoVazio">
      <!-- Itera sobre os itens do carrinho para exibir nome e quantidade. -->
      <div class="item-carrinho" *ngFor="let item of carrinho; let i = index">
        <div class="info-item">
          <h4>{{ item.nome }}</h4>
          <span class="quantidade-item">Quantidade: {{ item.quantidade }}</span>
        </div>
        <!-- Botão de remover item específico com base no índice i. -->
        <button class="botao-remover" (click)="removerDoCarrinho(i)">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>
    
    <!-- Template mostrado quando o carrinho está vazio. -->
    <ng-template #carrinhoVazio>
      <div class="carrinho-vazio">
        <i class="fas fa-shopping-cart icone-vazio"></i>
        <p>Seu carrinho está vazio</p>
      </div>
    </ng-template>
    
    <!-- Rodapé da modal com ações: continuar ou finalizar. Só aparece se houver itens. -->
    <div class="rodape-modal" *ngIf="carrinho.length > 0">
      <button class="botao botao-secundario" (click)="fecharCarrinho()">
        <i class="fas fa-arrow-left"></i> Continuar Comprando
      </button>
      <button class="botao botao-primario" (click)="finalizarCompra()">
        <i class="fas fa-credit-card"></i> Finalizar Compra
      </button>
    </div>
  </div>
</div>

<!-- Cabeçalho hero da página com título, descrição e recursos. -->
<header class="cabecalho-principal">
  <div class="conteudo-cabecalho">
    <div class="texto-cabecalho">
      <h1>Farmácia Gilson</h1>
      <p>Sua saúde é nossa prioridade. Medicamentos com qualidade e preços acessíveis.</p>
    </div>
    <div class="recursos-cabecalho">
      <!-- Recurso destacado: entrega rápida. -->
      <div class="recurso">
        <i class="fas fa-truck"></i>
        <span>Entrega Rápida</span>
      </div>
      <!-- Recurso destacado: produtos originais. -->
      <div class="recurso">
        <i class="fas fa-shield-alt"></i>
        <span>Produtos Originais</span>
      </div>
      <!-- Recurso destacado: atendimento 24 horas. -->
      <div class="recurso">
        <i class="fas fa-clock"></i>
        <span>Atendimento 24h</span>
      </div>
    </div>
  </div>
</header>

<!-- Seção de categorias: filtros rápidos por tipo de produto. -->
<section class="categorias">
  <div class="container">
    <h2>Categorias</h2>
    <div class="grade-categoria">
      <!-- Card de categoria: Todos. [class.ativo] ativa visualmente quando selecionado. -->
      <div class="item-categoria" 
           [class.ativo]="categoriaAtiva === 'Todos'" 
           (click)="filtrarPorCategoria('Todos')">
        <i class="fas fa-th-large"></i>
        <span>Todos</span>
      </div>
      <!-- Categoria: Medicamentos. -->
      <div class="item-categoria" 
           [class.ativo]="categoriaAtiva === 'Medicamentos'" 
           (click)="filtrarPorCategoria('Medicamentos')">
        <i class="fas fa-pills"></i>
        <span>Medicamentos</span>
      </div>
      <!-- Categoria: Vitaminas. -->
      <div class="item-categoria" 
           [class.ativo]="categoriaAtiva === 'Vitaminas'" 
           (click)="filtrarPorCategoria('Vitaminas')">
        <i class="fas fa-heart"></i>
        <span>Vitaminas</span>
      </div>
      <!-- Categoria: Infantil. -->
      <div class="item-categoria" 
           [class.ativo]="categoriaAtiva === 'Infantil'" 
           (click)="filtrarPorCategoria('Infantil')">
        <i class="fas fa-baby"></i>
        <span>Infantil</span>
      </div>
      <!-- Categoria: Higiene. -->
      <div class="item-categoria" 
           [class.ativo]="categoriaAtiva === 'Higiene'" 
           (click)="filtrarPorCategoria('Higiene')">
        <i class="fas fa-soap"></i>
        <span>Higiene</span>
      </div>
      <!-- Categoria: Cosméticos. -->
      <div class="item-categoria" 
           [class.ativo]="categoriaAtiva === 'Cosméticos'" 
           (click)="filtrarPorCategoria('Cosméticos')">
        <i class="fas fa-eye"></i>
        <span>Cosméticos</span>
      </div>
      <!-- Categoria: Bucal. -->
      <div class="item-categoria" 
           [class.ativo]="categoriaAtiva === 'Bucal'" 
           (click)="filtrarPorCategoria('Bucal')">
        <i class="fas fa-tooth"></i>
        <span>Bucal</span>
      </div>
    </div>
  </div>
</section>

<!-- Seção com banner de promoções em destaque. -->
<section class="promocoes">
  <div class="container">
    <div class="banner-promocao">
      <div class="conteudo-promocao">
        <div class="icone-promocao">
          <i class="fas fa-fire"></i>
        </div>
        <div class="texto-promocao">
          <h2>Promoções da Semana</h2>
          <p>Descontos especiais em medicamentos selecionados. Entrega grátis para compras acima de R$ 50,00!</p>
        </div>
        <div class="selo-promocao">
          <span>ATÉ 30% OFF</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Catálogo de produtos filtrável e com âncora (id usado para rolagem). -->
<section class="secao-produtos" id="secao-produtos">
  <div class="container">
    <div class="cabecalho-secao">
      <!-- Cabeçalho dinâmico de resultados: mostra contagem e contexto conforme filtros/termo. -->
      <div class="resultados-busca" *ngIf="termoPesquisa.length > 0 || categoriaAtiva !== 'Todos'">
        <!-- Título quando há termo pesquisado. -->
        <h2 *ngIf="termoPesquisa.length > 0">
          Resultados para "{{ termoPesquisa }}" ({{ produtosFiltrados.length }} encontrados)
        </h2>
        <!-- Título quando não há termo mas há uma categoria aplicada. -->
        <h2 *ngIf="termoPesquisa.length === 0 && categoriaAtiva !== 'Todos'">
          {{ categoriaAtiva }} ({{ produtosFiltrados.length }} produtos)
        </h2>
        <!-- Botão para limpar todos os filtros e voltar à listagem completa. -->
        <button class="botao-filtro" style="margin-bottom: 30px;" (click)="limparTodosFiltros()">
          <i class="fas fa-times"></i> Limpar filtros
        </button>
      </div>
      <!-- Título padrão quando não há filtros e nenhum termo de busca. -->
      <h2 *ngIf="termoPesquisa.length === 0 && categoriaAtiva === 'Todos'">Nossos Medicamentos</h2>
      
      <!-- Conjunto de filtros por tipo de produto (mutuamente exclusivos). -->
      <div class="opcoes-filtro">
        <button 
          class="botao-filtro" 
          [class.ativo]="filtroAtivo === 'Todos'"
          (click)="filtrarProdutos('Todos')">
          Todos
        </button>
        <button 
          class="botao-filtro" 
          [class.ativo]="filtroAtivo === 'Genéricos'"
          (click)="filtrarProdutos('Genéricos')">
          Genéricos
        </button>
        <button 
          class="botao-filtro" 
          [class.ativo]="filtroAtivo === 'Referência'"
          (click)="filtrarProdutos('Referência')">
          Referência
        </button>
        <button 
          class="botao-filtro" 
          [class.ativo]="filtroAtivo === 'Similares'"
          (click)="filtrarProdutos('Similares')">
          Similares
        </button>
      </div>
    </div>
    
    <!-- Mensagem amigável quando a busca não retorna produtos. -->
    <div class="nenhum-produto" *ngIf="produtosFiltrados.length === 0 && termoPesquisa.length > 0">
      <div class="conteudo-nenhum-produto">
        <i class="fas fa-search icone-nenhum-produto"></i>
        <h3>Nenhum produto encontrado</h3>
        <p>Não encontramos medicamentos para sua pesquisa.</p>
        <button class="botao botao-primario" (click)="limparPesquisa()">
          <i class="fas fa-refresh"></i> Ver todos os produtos
        </button>
      </div>
    </div>
    
    <!-- Grade de cards de produto quando houver itens filtrados. -->
    <div class="grade-produtos" *ngIf="produtosFiltrados.length > 0">
      <!-- Cada card representa um produto disponível. -->
      <div class="cartao-produto" *ngFor="let produto of produtosFiltrados">
        <div class="imagem-produto">
          <!-- Imagem do produto com src dinâmico e alt para acessibilidade. -->
          <img [src]="produto.imagem" [alt]="produto.nome">
          <!-- Selo de promoção aparece somente quando há desconto. -->
          <div class="selo-produto" *ngIf="produto.promocao">
            <span>-{{ produto.desconto }}%</span>
          </div>
        </div>
        
        <div class="info-produto">
          <h3>{{ produto.nome }}</h3>
          <p class="descricao-produto">{{ produto.descricao }}</p>
          
          <div class="detalhes-produto">
            <div class="secao-preco">
              <span class="preco-atual">{{ produto.preco }}</span>
              <span class="preco-antigo" *ngIf="produto.precoAntigo">{{ produto.precoAntigo }}</span>
            </div>
            
            <!-- Informação de estoque com destaque quando quantidade for baixa. -->
            <div class="info-estoque">
              <i class="fas fa-box" [class.estoque-baixo]="produto.quantidade < 5"></i>
              <span [class.estoque-baixo]="produto.quantidade < 5">
                {{ produto.quantidade }} em estoque
              </span>
            </div>
          </div>
          
          <div class="acoes-produto">
            <!-- Botão de adicionar ao carrinho; fica desabilitado se o produto estiver indisponível. -->
            <button class="botao botao-primario" (click)="adicionarAoCarrinho(produto.nome)" [disabled]="produto.quantidade === 0">
              <i class="fas fa-cart-plus"></i>
              {{ produto.quantidade === 0 ? 'Indisponível' : 'Adicionar ao Carrinho' }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Seção informativa sobre segurança e automedicação. -->
<section class="info-seguranca">
  <div class="container">
    <div class="conteudo-seguranca">
      <div class="icone-seguranca">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <div class="texto-seguranca">
        <h3>Importante</h3>
        <p>Medicamentos podem causar efeitos indesejados. Evite a automedicação: informe-se com o farmacêutico.</p>
      </div>
    </div>
  </div>
</section>

<!-- Rodapé com informações institucionais, contato, endereço e certificações. -->
<footer class="rodape-principal">
  <div class="conteudo-rodape">
    <div class="secao-rodape">
      <h4>Farmácia Gilson</h4>
      <p>Compromisso com sua saúde e bem-estar há mais de 20 anos.</p>
      <div class="links-sociais">
        <a href="#"><i class="fab fa-facebook"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
        <a href="#"><i class="fab fa-whatsapp"></i></a>
      </div>
    </div>
    
    <div class="secao-rodape">
      <h4>Atendimento</h4>
      <p><i class="fas fa-phone"></i> (89) 99461-0025</p>
      <p><i class="fas fa-envelope"></i> contato&#64;farmagilson.com</p>
      <p><i class="fas fa-clock"></i> Seg-Dom: 24 horas</p>
    </div>
    
    <div class="secao-rodape">
      <h4>Endereço</h4>
      <p><i class="fas fa-map-marker-alt"></i> R. Cel. Antônio Rodrigues, 28</p>
      <p>Centro, Picos - PI</p>
      <p>CEP: 64600-028</p>
    </div>
    
    <div class="secao-rodape">
      <h4>Certificações</h4>
      <div class="certificacoes">
        <div class="item-certificacao">
          <i class="fas fa-certificate"></i>
          <span>ANVISA</span>
        </div>
        <div class="item-certificacao">
          <i class="fas fa-shield-alt"></i>
          <span>CRF-PI</span>
        </div>
      </div>
    </div>
  </div>
  
  <div class="parte-inferior-rodape">
    <p>&copy; 2025 Farmácia Gilson. Todos os direitos reservados.</p>
    <p>CNPJ: 12.345.678/0001-90 | Responsável Técnico: Dr. Gilson Silva - CRF-PI 12345</p>
  </div>
</footer>

<!-- Inclusão do CSS do Font Awesome para ícones. Observação: normalmente isso fica em index.html,
     mas aqui funciona localmente para este template específico. -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
